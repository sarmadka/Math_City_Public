صنف مـلصق {
    //==========
    // المتغيرات

    عرف نقش: سـندنا[نـقش_متعدد]؛
    عرف س: صحيح؛
    عرف ص: صحيح؛
    عرف الحالي: صحيح؛
    عرف شفافية: طـبيعي[8] = 255؛
    عرف مشهد: سند[مـشهد]؛
    مشهد~مؤشر = 0؛

    //=========
    // التهيئات

    عملية هذا~هيئ() {}
    عملية هذا~هيئ(بادئة_الملف: نـص) هذا.هيئ(بادئة_الملف)؛
    عملية هذا~هيئ(بادئة_الملف: نـص، س: صحيح، ص: صحيح) {
        هذا.هيئ(بادئة_الملف)؛
        هذا.س = س؛
        هذا.ص = ص؛
    }
    عملية هذا~هيئ(ع: صحيح، ط: صحيح) هذا.هيئ(ع، ط)؛
    عملية هذا~هيئ(ع: صحيح، ط: صحيح، حالات: صحيح) هذا.هيئ(ع، ط، حالات)؛
    عملية هذا~هيئ(نقش: سـندنا[نـقش_متعدد]) هذا.هيئ(نقش)؛
    عملية هذا~هيئ(ملصق: سند[مـلصق]) هذا.انسخ(ملصق)؛
    عملية هذا~أتلف() {
        إذا هذا.مشهد~مؤشر != 0 هذا.مشهد.أزل_ملصق(هذا)؛
    }
    عملية هذا=سند[مـلصق] هذا.انسخ(قيمة)؛

    عملية هذا.هيئ (بادئة_الملف: نـص، تحجيم: صـحيح): سـندنا[مـؤجلات.مـؤجلة[صـحيح]] {
        هذا.الحالي = 0؛
        هذا.نقش.أنشئ()؛
        أرجع هذا.نقش.هيئ(بادئة_الملف، تحجيم)؛
    }

    عملية هذا.هيئ (بادئة_الملف: نـص، تحجيم: صـحيح، س: صـحيح، ص: صـحيح): سـندنا[مـؤجلات.مـؤجلة[صـحيح]] {
        هذا.ضع(س، ص)؛
        أرجع هذا.هيئ(بادئة_الملف، تحجيم)؛
    }

    عملية هذا.هيئ (ع: صحيح، ط: صحيح) {
        هذا.هيئ(ع، ط، 1)؛
    }

    عملية هذا.هيئ (ع: صحيح، ط: صحيح، حالات: صحيح) {
        هذا.نقش.احجز()~تتبع~هيئ(ع، ط، حالات)؛
        هذا.الحالي = 0؛
    }

    عملية هذا.هيئ (نقش: سـندنا[نـقش_متعدد]) {
        هذا.نقش = نقش؛
        هذا.الحالي = 0؛
    }

    //=========
    // العمليات

    عملية هذا.عدد_الحالات: صـحيح {
        إذا هذا.نقش.أهو_عدم() أرجع 0 وإلا ارجع هذا.نقش.عدد_الحالات؛
    }

    عملية هذا.انسخ (ملصق: سند[مـلصق]) {
        هذا.نقش = ملصق.نقش؛
        هذا.س = ملصق.س؛
        هذا.ص = ملصق.ص؛
        هذا.الحالي = ملصق.الحالي؛
        هذا.شفافية = ملصق.شفافية؛
    }

    عملية هذا.ضع (س: صحيح، ص: صحيح) {
        هذا.س = س؛
        هذا.ص = ص؛
    }

    عملية هذا.ارسم (شفافية: صحيح) {
        إذا هذا.نقش.كائن~مؤشر == 0 أو هذا.شفافية == 0 أو هذا.الحالي < 0 ارجع؛
        هذا.نقش.اطمغ(هذا.س، هذا.ص، (هذا.شفافية * شفافية) ÷ 255، هذا.الحالي)؛
    }

    عملية هذا.عرض: صـحيح {
        إذا هذا.نقش.أهو_عدم() أرجع 0 وإلا أرجع هذا.نقش.عرض؛
    }

    عملية هذا.طول: صـحيح {
        إذا هذا.نقش.أهو_عدم() أرجع 0 وإلا أرجع هذا.نقش.طول؛
    }
}
