صنف لـوح_مفاتيح {
    عرف _عرض_ : 120؛
    عرف _طول_ : 150؛
    عرف أزرار: مـصفوفة[مـلصق]؛
    عرف أعلى_للتو: ثنائي = 0؛
    عرف يمين_للتو: ثنائي = 0؛
    عرف يسار_للتو: ثنائي = 0؛
    عرف أسفل_للتو: ثنائي = 0؛
    عرف تفاعل_للتو: ثنائي = 0؛
    عرف محو_للتو: ثنائي = 0؛
    عرف الرقم: صحيح = -1؛


    عملية هذا.هيئ(س:صحيح، ص:صحيح، ه:صحيح): سـندنا[مـؤجلات.مـؤجلة[صـحيح]] {
        أرجع مـؤجلات.مـؤجلة[مـلصق].الكل({
            حمل_ملصقا(نـص("رسوم/لوح_مفاتيح/رقم0")، 0)،
            حمل_ملصقا(نـص("رسوم/لوح_مفاتيح/رقم1")، 0)،
            حمل_ملصقا(نـص("رسوم/لوح_مفاتيح/رقم2")، 0)،
            حمل_ملصقا(نـص("رسوم/لوح_مفاتيح/رقم3")، 0)،
            حمل_ملصقا(نـص("رسوم/لوح_مفاتيح/رقم4")، 0)،
            حمل_ملصقا(نـص("رسوم/لوح_مفاتيح/رقم5")، 0)،
            حمل_ملصقا(نـص("رسوم/لوح_مفاتيح/رقم6")، 0)،
            حمل_ملصقا(نـص("رسوم/لوح_مفاتيح/رقم7")، 0)،
            حمل_ملصقا(نـص("رسوم/لوح_مفاتيح/رقم8")، 0)،
            حمل_ملصقا(نـص("رسوم/لوح_مفاتيح/رقم9")، 0)،
            حمل_ملصقا(نـص("رسوم/لوح_مفاتيح/إدخال")، 0)،
            حمل_ملصقا(نـص("رسوم/لوح_مفاتيح/محو")، 0)،
            حمل_ملصقا(نـص("رسوم/لوح_مفاتيح/فوق")، 0)،
            حمل_ملصقا(نـص("رسوم/لوح_مفاتيح/أسفل")، 0)،
            حمل_ملصقا(نـص("رسوم/لوح_مفاتيح/يمين")، 0)،
            حمل_ملصقا(نـص("رسوم/لوح_مفاتيح/يسار")، 0)،
            حمل_ملصقا(نـص("رسوم/لوح_مفاتيح/فعل")، 0)،
        }).ثم[صـحيح](مغلفة (ملصقات: مـصفوفة[مـلصق]، م: سند[مـؤجلات.مـؤجلة[صـحيح]]) {
            هذا.أزرار = ملصقات؛
            إذا ه == 0 {
                هذا.أزرار(0).ضع(س ، ص)؛
                هذا.أزرار(1).ضع(س + _عرض_، ص)؛
                هذا.أزرار(2).ضع(س + (_عرض_ * 2)، ص)؛
                هذا.أزرار(3).ضع(س ، ص + _طول_)؛
                هذا.أزرار(4).ضع(س + _عرض_، ص + _طول_)؛
                هذا.أزرار(5).ضع(س + (_عرض_ * 2)، ص + _طول_)؛
                هذا.أزرار(6).ضع(س، ص + (_طول_ * 2))؛
                هذا.أزرار(7).ضع(س + _عرض_، ص + (_طول_ * 2))؛
                هذا.أزرار(8).ضع(س + (_عرض_ * 2)، ص + (_طول_ * 2))؛
                هذا.أزرار(9).ضع(س، ص + (_طول_ * 3))؛
                هذا.أزرار(12).ضع(س + _عرض_، ص + (_طول_ * 3))؛
                هذا.أزرار(13).ضع(س + _عرض_، ص + (_طول_ * 4))؛
                هذا.أزرار(14).ضع(س + (_عرض_ * 2)، ص + (_طول_ * 4))؛
                هذا.أزرار(15).ضع(س، ص + (_طول_ * 4))؛
                هذا.أزرار(16).ضع(س + (_عرض_ * 2)، ص + (_طول_ * 3))؛
            }؛

            إذا ه == 1 {
                هذا.أزرار(16).ضع(س + _عرض_، ص + _طول_)؛
                هذا.أزرار(12).ضع(س + _عرض_، ص)؛
                هذا.أزرار(13).ضع(س + _عرض_، ص + (_طول_ * 2))؛
                هذا.أزرار(14).ضع(س + (_عرض_ * 2)، ص + _طول_)؛
                هذا.أزرار(15).ضع(س، ص + _طول_)؛
            }؛

            إذا ه == 2 {
                هذا.أزرار(15).ضع(س، ص)؛
                هذا.أزرار(16).ضع(س + _عرض_، ص)؛
                هذا.أزرار(14).ضع(س + (_عرض_ * 2)، ص)؛
            }؛

            إذا ه ==3 {
                هذا.أزرار(0).ضع(س ، ص)؛
                هذا.أزرار(1).ضع(س + _عرض_، ص)؛
                هذا.أزرار(2).ضع(س + (_عرض_ * 2)، ص)؛
                هذا.أزرار(3).ضع(س + (_عرض_ * 3)، ص)؛
                هذا.أزرار(4).ضع(س + (_عرض_ * 4)، ص)؛
                هذا.أزرار(5).ضع(س + (_عرض_ * 5)، ص)؛
                هذا.أزرار(6).ضع(س + (_عرض_ * 6)، ص)؛
                هذا.أزرار(7).ضع(س + (_عرض_ * 7)، ص)؛
                هذا.أزرار(8).ضع(س + (_عرض_ * 8)، ص)؛
                هذا.أزرار(9).ضع(س + (_عرض_ * 9)، ص)؛
            }؛

            إذا ه == 4 {
                 هذا.أزرار(0).ضع(س ، ص)؛
                هذا.أزرار(1).ضع(س + _عرض_، ص)؛
                هذا.أزرار(2).ضع(س + (_عرض_ * 2)، ص)؛
                هذا.أزرار(3).ضع(س ، ص + _طول_)؛
                هذا.أزرار(4).ضع(س + _عرض_، ص + _طول_)؛
                هذا.أزرار(5).ضع(س + (_عرض_ * 2)، ص + _طول_)؛
                هذا.أزرار(6).ضع(س، ص + (_طول_ * 2))؛
                هذا.أزرار(7).ضع(س + _عرض_، ص + (_طول_ * 2))؛
                هذا.أزرار(8).ضع(س + (_عرض_ * 2)، ص + (_طول_ * 2))؛
                هذا.أزرار(9).ضع(س، ص + (_طول_ * 3))؛
                هذا.أزرار(10).ضع(س + _عرض_، ص + (_طول_ * 3))؛
                هذا.أزرار(11).ضع(س + (_عرض_ * 2)، ص + (_طول_ * 3))؛
            }؛

            إذا ه == 5 {
                هذا.أزرار(12).ضع(س + _عرض_، ص)؛
                هذا.أزرار(13).ضع(س + _عرض_، ص + _طول_)؛
                هذا.أزرار(14).ضع(س + (_عرض_ * 2)، ص + _طول_)؛
                هذا.أزرار(15).ضع(س، ص + _طول_)؛
            }؛

            إذا ه == 6 {
                هذا.أزرار(0).ضع(س ، ص)؛
                هذا.أزرار(1).ضع(س + _عرض_، ص)؛
                هذا.أزرار(2).ضع(س، ص + _طول_)؛
                هذا.أزرار(3).ضع(س + _عرض_، ص + _طول_)؛
                هذا.أزرار(4).ضع(س، ص + (_طول_ * 2))؛
                هذا.أزرار(5).ضع(س + _عرض_، ص + (_طول_ * 2))؛
                هذا.أزرار(6).ضع(س، ص + (_طول_ * 3))؛
                هذا.أزرار(7).ضع(س + _عرض_، ص  + (_طول_ * 3))؛
                هذا.أزرار(8).ضع(س، ص  + (_طول_ * 4))؛
                هذا.أزرار(9).ضع(س + _عرض_، ص + (_طول_ * 4))؛
            }؛

            م.قرر(0)؛
        })؛
    }

    عملية هذا.ارسم (مشهد:سند[مـشهد]) {
        إذا هل_نحتاج_لوحة_المفاتيح == 1 {
            عرف ه: صحيح؛
            لكل ه = 0، ه < هذا.أزرار.هات_الطول()، ه++ {
                هذا.أزرار(ه).شفافية = 180؛
                مشهد.أضف_ملصق(هذا.أزرار(ه))؛
            }؛
        }؛
    }؛

    عملية هذا.احذف (مشهد:سند[مـشهد]) {
        عرف ه: صحيح؛
        لكل ه = 0، ه < هذا.أزرار.هات_الطول()، ه++ {
            هذا.أزرار(ه).شفافية = 180؛
            مشهد.أزل_ملصق(هذا.أزرار(ه))؛
        }؛
    }؛

    عملية هذا.حدث() {
        إذا هل_نحتاج_لوحة_المفاتيح == 1 {
            هذا.تفاعل_للتو = 0؛
            هذا.أعلى_للتو = 0؛
            هذا.يمين_للتو = 0؛
            هذا.أسفل_للتو = 0؛
            هذا.يسار_للتو = 0؛
            هذا.محو_للتو = 0؛
            هذا.الرقم = -1؛

            إذا تحكم.نقرة_للتو {
                عرف م: صـحيح؛
                لكل م = 0، م < هذا.أزرار.هات_الطول()، ++م {
                    إذا تحكم.س >= هذا.أزرار(م).س
                        و تحكم.س < هذا.أزرار(م).س + هذا.أزرار(م).عرض
                        و تحكم.ص >= هذا.أزرار(م).ص
                        و تحكم.ص < هذا.أزرار(م).ص + هذا.أزرار(م).طول
                    {
                        إذا م == 10 أو م == 16 هذا.تفاعل_للتو = 1
                        وإلا إذا م == 11 هذا.محو_للتو = 1
                        وإلا إذا م == 12 هذا.أعلى_للتو = 1
                        وإلا إذا م == 13 هذا.أسفل_للتو = 1
                        وإلا إذا م == 14 هذا.يمين_للتو = 1
                        وإلا إذا م == 15 هذا.يسار_للتو = 1
                        وإلا هذا.الرقم = م؛
                    }؛
                }؛
            }؛
        }؛
    }؛
}؛